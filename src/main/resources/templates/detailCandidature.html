<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ressources Humaines</title>
  <link rel="stylesheet" href="/css/detailCandidature.css">
</head>
<body>
  <header class="main-header">
    <div class="header-title">Détail de la Candidature</div>
    <a href="/AccueilRH" class="back-btn">Retour</a>
  </header>

  <div class="container">
    <!-- Informations principales -->
    <div class="section">
      <h2>Informations Générales</h2>
      <div class="info-grid">
        <div class="info-label">Nom :</div>
        <div class="info-value" th:text="${candidature.nom}">DUPONT</div>

        <div class="info-label">Prénom :</div>
        <div class="info-value" th:text="${candidature.prenom}">Jean</div>

        <div class="info-label">Poste visé :</div>
        <div class="info-value" th:text="${candidature.poste}">Développeur Full Stack</div>

        <div class="info-label">État :</div>
        <div class="info-value">
          <span th:if="${candidature.etat == -1}" class="badge badge-new">Nouvelle</span>
          <span th:if="${candidature.etat == 0}" class="badge badge-progress">En traitement</span>
          <span th:if="${candidature.etat == 1}" class="badge badge-accepted">Acceptée</span>
          <span th:if="${candidature.etat == 2}" class="badge badge-rejected">Refusée</span>
        </div>

        <div class="info-label">Stockage autorisé :</div>
        <div class="info-value" th:text="${candidature.stockage ? 'Oui' : 'Non'}">Oui</div>

        <div class="info-label">Partage autorisé :</div>
        <div class="info-value" th:text="${candidature.partage ? 'Oui' : 'Non'}">Non</div>
      </div>

      <div class="btn-row">
        <a th:href="@{/candidature/{id}/download/cv(id=${candidature.id})}" class="btn">Télécharger CV</a>
        <a th:href="@{/candidature/{id}/download/lm(id=${candidature.id})}" class="btn">Télécharger LM</a>
        <a th:href="@{/candidature/{id}/export/json(id=${candidature.id})}" class="btn">Exporter JSON</a>
      </div>
    </div>

    <!-- Données extraites du CV -->
    <div class="section" th:if="${cvData != null}">
      <h2>Données Extraites du CV</h2>
      
      <div class="info-grid">
        <div class="info-label">Email :</div>
        <div class="info-value" th:text="${cvData.email != null && !cvData.email.isEmpty() ? cvData.email : 'Non renseigné'}">email@example.com</div>

        <div class="info-label">Téléphone :</div>
        <div class="info-value" th:text="${cvData.telephone != null && !cvData.telephone.isEmpty() ? cvData.telephone : 'Non renseigné'}">06 12 34 56 78</div>

        <div class="info-label">Poste visé (CV) :</div>
        <div class="info-value" th:text="${cvData.posteVise != null && !cvData.posteVise.isEmpty() ? cvData.posteVise : 'Non renseigné'}">Développeur</div>

        <div class="info-label">Permis :</div>
        <div class="info-value" th:text="${permis}">Permis B</div>
      </div>

      <div class="list-section">
        <h3>Diplômes</h3>
        <div th:if="${diplomes != null && !diplomes.isEmpty()}">
          <div class="list-item" th:each="diplome : ${diplomes}">
            <strong th:text="${diplome.nomDiplome}">Master Informatique</strong>
            <span th:text="' - ' + ${diplome.anneeObtention}"> - 2023</span>
          </div>
        </div>
        <div th:if="${diplomes == null || diplomes.isEmpty()}" class="no-data">
          Aucun diplôme extrait
        </div>
      </div>

      <div class="list-section">
        <h3>Expériences Professionnelles</h3>
        <div th:if="${experiences != null && !experiences.isEmpty()}">
          <div class="list-item" th:each="exp : ${experiences}">
            <strong th:text="${exp.posteOccupe}">Développeur</strong><br>
            <span th:text="${exp.nomEntreprise}">Entreprise ABC</span><br>
            <span th:text="${exp.dureeExperience}" style="color: #9aa7c2;">2020 - 2023</span>
          </div>
        </div>
        <div th:if="${experiences == null || experiences.isEmpty()}" class="no-data">
          Aucune expérience extraite
        </div>
      </div>

      <div class="list-section">
        <h3>Compétences</h3>
        <div th:if="${competences != null && !competences.isEmpty()}">
          <div class="competence-list">
            <span th:each="comp : ${competences}" th:text="${comp}" class="competence-tag">Java</span>
          </div>
        </div>
        <div th:if="${competences == null || competences.isEmpty()}" class="no-data">
          Aucune compétence extraite
        </div>
      </div>
    </div>

    <div class="section" th:if="${cvData == null}">
      <h2>Aucune donnée extraite</h2>
      <p class="no-data">Les données du CV n'ont pas encore été extraites ou une erreur s'est produite lors de l'extraction.</p>
    </div>
  </div>
</body>
</html>
